<!doctype html>
<html lang="fa" dir="rtl">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>تست لندینگ روز کودک (هم‌شکل PHP)</title>

    <!-- استایل بحرانی برای جلوگیری از فلیکر و انطباق با PHP -->
    <style>
        html {
            background: #248a4a !important;
        }

        body {
            background: #248a4a !important;
            color: #ffffff !important;
            margin: 0;
        }

        .child-day-landing {
            background: #248a4a !important;
            color: #ffffff !important;
        }

        .decor-right,
        .decor-right-2,
        .decor-right-3 {
            position: absolute !important;
            z-index: 5 !important;
            display: block !important;
        }

        .decor-right {
            top: 50% !important;
            right: 10px !important;
        }

        .decor-right-2 {
            top: 80% !important;
            left: 10px !important;
        }

        .decor-right-3 {
            top: 90% !important;
            right: 10px !important;
        }

        @media (max-width: 767px) {

            .site-header .mobile-nav,
            .site-header .mobile-toggle,
            .off-canvas,
            .off-canvas-trigger {
                display: none !important;
            }
        }

        @media (min-width: 768px) {

            .site-header .main-nav,
            .site-header .desktop-menu {
                display: block !important;
            }
        }
    </style>

    <link rel="stylesheet" href="landings_assets/css/child-day.css" type="text/css" media="all" />
    <style>
      /* Force progress line visibility in local test */
      .player-row{ padding-bottom:8px !important; }
      .player-progress{ background:#ffffff !important; height:4px !important; margin-top:0 !important; border-radius:999px !important; }
      .player-progress>.bar{ background:#2fb4ff !important; height:100% !important; width:30% !important; }
    </style>
    <!-- حذف استایل‌های دیباگ نوار پیشرفت در تست -->
</head>

<body>
    <main class="child-day-landing" role="main" aria-labelledby="headline">
        <section class="child-day-hero">
            <div class="hero-banner" aria-hidden="true">
                <picture>
                    <source media="(max-width: 767px)"
                        srcset="https://club.snapp.ir/wp-content/uploads/2025/10/Visual.png" sizes="100vw">
                    <source media="(min-width: 768px)"
                        srcset="https://club.snapp.ir/wp-content/uploads/2025/10/Desktop-Banner.png" sizes="100vw">
                    <img src="https://club.snapp.ir/wp-content/uploads/2025/10/Desktop-Banner.png" alt=""
                        loading="eager" decoding="async" />
                </picture>
            </div>

            <p class="child-desc">مامان و بابای مهربون، توی این صفحه ۷ شب، ۷ تا قصه‌ گفته می‌شه. هر شب باید قصه‌ی جدید
                رو برای کودک عزیز و خلاقتون پخش کنین، کمکش کنین معما رو حل کنه و در نهایت روز هفتم، نقاشی‌ای که از
                نقشه‌ی «شلغم‌رود» کشیده رو توی همین صفحه آپلود کنین تا بتونه توی قرعه‌کشی شرکت کنه. ۱۰ تا جایزه‌ی جذاب،
                در انتظار ۱۰ تا کودکیه که کامل‌ترین نقاشی رو برامون بفرستن.</p>
            <p class="child-cta">آماده‌این؟ برای شروع «مقدمه» رو همراه با کودکتون بشنوین.</p>

            <div class="decor-right" aria-hidden="true">
                <img src="https://club.snapp.ir/wp-content/uploads/2025/10/01.svg" alt="" />
            </div>
            <div class="decor-right-2" aria-hidden="true">
                <img src="https://club.snapp.ir/wp-content/uploads/2025/10/5.svg" alt="" />
            </div>
            <div class="decor-right-3" aria-hidden="true">
                <img src="https://club.snapp.ir/wp-content/uploads/2025/10/Moon.svg" alt="" />
            </div>
        </section>

        <section class="player-card" dir="rtl" aria-label="پلیر مقدمه">
            <div class="player-row">
                <div class="player-title">مقدمه</div>
                <div class="player-actions">
                    <button class="player-btn fav" aria-label="علاقه‌مندی"><img
                            src="https://club.snapp.ir/wp-content/uploads/2025/10/Like-none.svg" alt="" width="20"
                            height="20" /></button>
                    <button class="player-btn play" id="playBtn" aria-label="پخش/توقف"><img
                            src="https://club.snapp.ir/wp-content/uploads/2025/10/play-Circle.svg" alt="" width="20"
                            height="20" /></button>
                    <button class="player-btn download" id="downloadBtn" aria-label="دانلود"><img
                            src="https://club.snapp.ir/wp-content/uploads/2025/10/import.svg" alt="" width="20"
                            height="20" /></button>
                </div>
            </div>
            <div class="player-progress" id="progress">
                <div class="bar" id="bar"></div>
            </div>
            <div class="player-times"><span id="curTime">00:00</span><span id="durTime">00:00</span></div>
            <audio id="audio" preload="auto" crossorigin="anonymous" playsinline
                src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>
        </section>

        

        <!-- قصه اول: پلیر -->
        <section class="player-card" dir="rtl" aria-label="پلیر قصه اول">
          <div class="player-row">
            <div class="player-title">قصه‌ی اول</div>
            <div class="player-actions">
              <button class="player-btn fav" aria-label="علاقه‌مندی"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/Like-none.svg" alt="" width="20" height="20"/></button>
              <button class="player-btn play" aria-label="پخش/توقف"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/play-Circle.svg" alt="" width="20" height="20"/></button>
              <button class="player-btn download" aria-label="دانلود"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/import.svg" alt="" width="20" height="20"/></button>
            </div>
          </div>
          <div class="player-progress"><div class="bar"></div></div>
          <div class="player-times"><span>00:00</span><span>00:00</span></div>
          <audio preload="auto" crossorigin="anonymous" src="https://club.snapp.ir/wp-content/uploads/2025/10/E1.mp3"></audio>
        </section>
        
        <!-- تایمر زیر قصه اول -->
        <div class="countdown-wrap">
          <div class="countdown" data-countdown data-target-time="18:00">
            <span class="dot"></span>
            <span class="time">00:00:00</span>
          </div>
          <div class="countdown-text">منتظر قصه بعدی باشید!</div>
        </div>

        <!-- قصه دوم: پلیر جدید مطابق صفحه PHP -->
        <section class="player-card" dir="rtl" aria-label="پلیر قصه دوم">
          <div class="player-row">
            <div class="player-title">قصه‌ی دوم</div>
            <div class="player-actions">
              <button class="player-btn fav" aria-label="علاقه‌مندی"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/Like-none.svg" alt="" width="20" height="20"/></button>
              <button class="player-btn play" aria-label="پخش/توقف"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/play-Circle.svg" alt="" width="20" height="20"/></button>
              <button class="player-btn download" aria-label="دانلود"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/import.svg" alt="" width="20" height="20"/></button>
            </div>
          </div>
          <div class="player-progress"><div class="bar"></div></div>
          <div class="player-times"><span>00:00</span><span>00:00</span></div>
          <audio preload="auto" crossorigin="anonymous" playsinline webkit-playsinline src="https://club.snapp.ir/wp-content/uploads/2025/10/E2.mp3"></audio>
        </section>
        
        <!-- قصه سوم: پلیر جدید -->
        <section class="player-card" dir="rtl" aria-label="پلیر قصه سوم">
          <div class="player-row">
            <div class="player-title">قصه‌ی سوم</div>
            <div class="player-actions">
              <button class="player-btn fav" aria-label="علاقه‌مندی"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/Like-none.svg" alt="" width="20" height="20"/></button>
              <button class="player-btn play" aria-label="پخش/توقف"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/play-Circle.svg" alt="" width="20" height="20"/></button>
              <button class="player-btn download" aria-label="دانلود"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/import.svg" alt="" width="20" height="20"/></button>
            </div>
          </div>
          <div class="player-progress"><div class="bar"></div></div>
          <div class="player-times"><span>00:00</span><span>00:00</span></div>
          <audio preload="auto" crossorigin="anonymous" playsinline webkit-playsinline src="https://club.snapp.ir/wp-content/uploads/2025/10/E3.mp3"></audio>
        </section>
        
        <!-- قصه چهارم: پلیر جدید -->
        <section class="player-card" dir="rtl" aria-label="پلیر قصه چهارم">
          <div class="player-row">
            <div class="player-title">قصه‌ی چهارم</div>
            <div class="player-actions">
              <button class="player-btn fav" aria-label="علاقه‌مندی"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/Like-none.svg" alt="" width="20" height="20"/></button>
              <button class="player-btn play" aria-label="پخش/توقف"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/play-Circle.svg" alt="" width="20" height="20"/></button>
              <button class="player-btn download" aria-label="دانلود"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/import.svg" alt="" width="20" height="20"/></button>
            </div>
          </div>
          <div class="player-progress"><div class="bar"></div></div>
          <div class="player-times"><span>00:00</span><span>00:00</span></div>
          <audio preload="auto" crossorigin="anonymous" playsinline webkit-playsinline src="https://club.snapp.ir/wp-content/uploads/2025/10/E4.mp3"></audio>
        </section>
        
        <!-- قصه پنجم: پلیر جدید -->
        <section class="player-card" dir="rtl" aria-label="پلیر قصه پنجم">
          <div class="player-row">
            <div class="player-title">قصه‌ی پنجم</div>
            <div class="player-actions">
              <button class="player-btn fav" aria-label="علاقه‌مندی"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/Like-none.svg" alt="" width="20" height="20"/></button>
              <button class="player-btn play" aria-label="پخش/توقف"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/play-Circle.svg" alt="" width="20" height="20"/></button>
              <button class="player-btn download" aria-label="دانلود"><img src="https://club.snapp.ir/wp-content/uploads/2025/10/import.svg" alt="" width="20" height="20"/></button>
            </div>
          </div>
          <div class="player-progress"><div class="bar"></div></div>
          <div class="player-times"><span>00:00</span><span>00:00</span></div>
          <audio preload="auto" crossorigin="anonymous" playsinline webkit-playsinline src="https://club.snapp.ir/wp-content/uploads/2025/10/E5.mp3"></audio>
        </section>
    </main>

    <script src="landings_assets/js/child-player.js"></script>
    <script src="landings_assets/js/countdown.js"></script>
    
    <!-- اسکریپت موبایل برای حل مشکل کلیک -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      var isMobile = window.innerWidth <= 768;
      
      if (isMobile) {
        console.log('Mobile detected - applying touch fixes');
        
        // حذف همه event listener های قدیمی
        var allPlayBtns = document.querySelectorAll('.player-btn.play');
        allPlayBtns.forEach(function(btn) {
          // حذف event listener های قدیمی
          btn.replaceWith(btn.cloneNode(true));
        });
        
        // اضافه کردن event listener های جدید
        setTimeout(function() {
          var newPlayBtns = document.querySelectorAll('.player-btn.play');
          newPlayBtns.forEach(function(btn) {
            // تنظیمات CSS اجباری
            btn.style.pointerEvents = 'auto !important';
            btn.style.touchAction = 'manipulation !important';
            btn.style.zIndex = '999999 !important';
            btn.style.position = 'relative !important';
            btn.style.display = 'block !important';
            btn.style.visibility = 'visible !important';
            btn.style.opacity = '1 !important';
            
            // event listener برای کلیک
            btn.addEventListener('click', function(e) {
              console.log('Mobile play button clicked');
              e.preventDefault();
              e.stopPropagation();
              e.stopImmediatePropagation();
              
              var audio = btn.closest('.player-card').querySelector('audio');
              var playImg = btn.querySelector('img');
              
              if (audio) {
                console.log('Audio found:', audio.src);
                
                // تغییر آیکون قبل از پخش
                if (audio.paused) {
                  // تغییر به pause
                  if (playImg) {
                    var src = playImg.getAttribute('src') || '';
                    var lastSlash = src.lastIndexOf('/');
                    var dir = lastSlash > -1 ? src.slice(0, lastSlash + 1) : 'https://club.snapp.ir/wp-content/uploads/2025/10/';
                    playImg.src = dir + 'pause-Circle.svg';
                  }
                  btn.setAttribute('aria-pressed', 'true');
                  
                  // نمایش کنترل‌های بومی
                  audio.setAttribute('controls', 'controls');
                  audio.style.display = 'block';
                  audio.style.width = '100%';
                  audio.style.marginTop = '10px';
                  audio.style.background = 'rgba(255,255,255,0.1)';
                  audio.style.borderRadius = '8px';
                  audio.style.padding = '8px';
                  audio.style.border = '1px solid rgba(255,255,255,0.2)';
                  audio.style.zIndex = '999999';
                  
                  // تلاش برای پخش
                  audio.play().then(function() {
                    console.log('Audio playing successfully');
                  }).catch(function(error) {
                    console.error('Audio play failed:', error);
                    // برگشت آیکون در صورت شکست
                    if (playImg) {
                      var src = playImg.getAttribute('src') || '';
                      var lastSlash = src.lastIndexOf('/');
                      var dir = lastSlash > -1 ? src.slice(0, lastSlash + 1) : 'https://club.snapp.ir/wp-content/uploads/2025/10/';
                      playImg.src = dir + 'play-Circle.svg';
                    }
                    btn.setAttribute('aria-pressed', 'false');
                    alert('برای پخش صدا، روی دکمه پخش در کنترل‌های صوتی کلیک کنید');
                  });
                } else {
                  // توقف و تغییر آیکون
                  audio.pause();
                  if (playImg) {
                    var src = playImg.getAttribute('src') || '';
                    var lastSlash = src.lastIndexOf('/');
                    var dir = lastSlash > -1 ? src.slice(0, lastSlash + 1) : 'https://club.snapp.ir/wp-content/uploads/2025/10/';
                    playImg.src = dir + 'play-Circle.svg';
                  }
                  btn.setAttribute('aria-pressed', 'false');
                }
              }
            }, { capture: true, passive: false });
            
            // event listener برای لمس
            btn.addEventListener('touchstart', function(e) {
              console.log('Mobile touch start on play button');
              e.preventDefault();
              e.stopPropagation();
              e.stopImmediatePropagation();
            }, { capture: true, passive: false });
            
            btn.addEventListener('touchend', function(e) {
              console.log('Mobile touch end on play button');
              e.preventDefault();
              e.stopPropagation();
              e.stopImmediatePropagation();
              
              // شبیه‌سازی کلیک
              btn.click();
            }, { capture: true, passive: false });
          });
        }, 500);
      }
    });
    </script>
</body>

</html>